---
deployment:
  tasks:
    # Set deploy path
    - export DEPLOYPATH=/home1/harmakko/public_html

    # Force sync all files to public_html ‚Äî overwrites existing files
    - rsync -av --checksum --exclude='.git' --exclude='.github' --exclude='.cpanel.yml' --exclude='README.md' --exclude='deploy.bat' . $DEPLOYPATH/

    # Set correct permissions
    - find $DEPLOYPATH/api -name "*.php" -exec chmod 644 {} \;
    - find $DEPLOYPATH -name "*.html" -exec chmod 644 {} \;
    - find $DEPLOYPATH -name "*.js" -exec chmod 644 {} \;
    - chmod 644 $DEPLOYPATH/.htaccess

    # Confirm
    - echo "‚úÖ HarmaalWale deployed successfully at $(date)"
    - echo "üìÅ Files in public_html:"
    - ls $DEPLOYPATH
